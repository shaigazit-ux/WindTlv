<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>תל אביב קייט | מדידות חוף</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
* { font-family: 'Assistant', sans-serif; }

/* ===== COLOR SYSTEM (sun-readable) ===== */
:root{
  --bg-main:#eaf6ff;
  --card:#ffffff;
  --primary:#0284c7;
  --accent:#0ea5e9;
  --wind:#0369a1;
  --text-main:#0f172a;
  --text-soft:#475569;
  --border-soft:#cbd5e1;
  --highlight:#fde047;
}

body{
  background: linear-gradient(180deg,#f0f9ff,#e0f2fe);
  color: var(--text-main);
  min-height:100vh;
}

/* ===== LAYOUT ===== */
.card{
  background:var(--card);
  border-radius:18px;
  border:1px solid var(--border-soft);
  box-shadow:0 8px 24px rgba(2,132,199,.08);
}

.badge{
  font-size:.7rem;
  background:#e0f2fe;
  color:var(--primary);
  padding:.15rem .5rem;
  border-radius:999px;
}

/* ===== COMPASS ===== */
.compass{
  width:140px;
  height:140px;
  border-radius:50%;
  border:2px solid var(--border-soft);
  position:relative;
  background:#f8fafc;
}

.compass::after{
  content:"";
  position:absolute;
  inset:10px;
  border-radius:50%;
  border:1px dashed #94a3b8;
}

.compass-degree{
  position:absolute;
  font-size:.65rem;
  color:#64748b;
}

.deg-n{top:6px;left:50%;transform:translateX(-50%)}
.deg-e{right:6px;top:50%;transform:translateY(-50%)}
.deg-s{bottom:6px;left:50%;transform:translateX(-50%)}
.deg-w{left:6px;top:50%;transform:translateY(-50%)}

.compass-arrow{
  position:absolute;
  bottom:50%;
  left:50%;
  width:4px;
  height:46px;
  background:linear-gradient(to top,var(--accent),var(--primary));
  transform-origin:bottom center;
  transform:translateX(-50%) rotate(0deg);
  border-radius:2px;
}

.compass-arrow::after{
  content:"";
  position:absolute;
  top:-8px;
  left:-5px;
  border-left:7px solid transparent;
  border-right:7px solid transparent;
  border-bottom:10px solid var(--primary);
}

/* ===== HISTORY ===== */
.history-container{
  position:relative;
  height:200px;
  background:#f8fafc;
  border-radius:14px;
  border:1px solid var(--border-soft);
  overflow:hidden;
}

.history-bar{
  position:absolute;
  bottom:0;
  border-radius:3px 3px 0 0;
}

.wind-weak{background:#94a3b8}
.wind-light{background:#22c55e}
.wind-good{background:#3b82f6}
.wind-strong{background:#f59e0b}
.wind-extreme{background:#ef4444}

.table-tight td,.table-tight th{
  padding:.3rem .4rem;
  font-size:.8rem;
}

@media(max-width:640px){
  .table-tight td,.table-tight th{font-size:.72rem}
}
</style>
</head>

<body class="px-4 py-6">

<header class="max-w-6xl mx-auto mb-6 flex justify-between items-center">
  <div>
    <h1 class="text-2xl font-bold">תל אביב קייט</h1>
    <p class="text-sm text-slate-500">מדד החוף</p>
  </div>
  <span class="badge">LIVE</span>
</header>

<main class="max-w-6xl mx-auto space-y-6">

<!-- ===== MAIN DASHBOARD ===== -->
<div class="card p-6 grid grid-cols-1 md:grid-cols-3 gap-6">

  <!-- WIND -->
  <div class="md:col-span-2">
    <p class="text-sm text-slate-500 mb-1">מהירות רוח ממוצעת</p>
    <div class="flex items-end gap-3">
      <span id="currentSpeed" class="text-6xl font-bold text-[color:var(--wind)]">--</span>
      <span class="text-xl mb-1">קשר</span>
    </div>

    <div class="grid grid-cols-4 gap-4 mt-4 text-center">
      <div>
        <p class="text-xs text-slate-500">כיוון</p>
        <p id="windDir" class="font-semibold">--</p>
      </div>
      <div>
        <p class="text-xs text-slate-500">משבים</p>
        <p id="windGust" class="font-semibold text-orange-500">--</p>
      </div>
      <div>
        <p class="text-xs text-slate-500">מים</p>
        <p id="waterTempMain" class="font-semibold text-teal-600">--</p>
      </div>
      <div>
        <p class="text-xs text-slate-500">חוף</p>
        <p id="temp" class="font-semibold">--</p>
      </div>
    </div>
  </div>

  <!-- COMPASS -->
  <div class="flex justify-center items-center">
    <div class="compass">
      <div class="compass-degree deg-n">0°</div>
      <div class="compass-degree deg-e">90°</div>
      <div class="compass-degree deg-s">180°</div>
      <div class="compass-degree deg-w">270°</div>
      <div id="compassArrow" class="compass-arrow"></div>
    </div>
  </div>
</div>

<!-- ===== HISTORY ===== -->
<div class="card p-6">
  <div class="flex justify-between items-center mb-4">
    <h2 class="text-lg font-bold">היסטוריית רוח</h2>
    <div class="flex gap-2">
      <button onclick="setIntervalMode('1min')" id="btn-1min" class="badge">1 דקה</button>
      <button onclick="setIntervalMode('15min')" id="btn-15min" class="badge">15 דקות</button>
    </div>
  </div>

  <div class="history-container mb-6" id="historyChart"></div>

  <div class="overflow-x-auto">
    <table class="w-full table-tight text-right">
      <thead class="text-slate-500 border-b">
        <tr>
          <th>שעה</th>
          <th>רוח</th>
          <th>משבים</th>
          <th class="text-center">כיוון</th>
          <th>גל</th>
          <th>מים</th>
        </tr>
      </thead>
      <tbody id="recentHoursTable"></tbody>
    </table>
  </div>
</div>

</main>

<script>
const KNOTS=1.94384;
const state={readings:[],currentInterval:'1min'};

function msToKnots(ms){return (ms*KNOTS).toFixed(1);}
function getDir(deg){
  const d=['צפון','צפון-מזרח','מזרח','דרום-מזרח','דרום','דרום-מערב','מערב','צפון-מערב'];
  return d[Math.round(deg/45)%8];
}
function getWindClass(k){
  if(k<10)return'wind-weak';
  if(k<15)return'wind-light';
  if(k<20)return'wind-good';
  if(k<25)return'wind-strong';
  return'wind-extreme';
}

function setIntervalMode(m){
  state.currentInterval=m;
  renderHistory();
}

/* ===== DEMO DATA (replace with your fetch) ===== */
setInterval(()=>{
  const deg=Math.random()*360;
  const speed=5+Math.random()*8;
  state.readings.push({
    timestamp:new Date(),
    speed,
    deg,
    gust:speed*1.3,
    wave:.6+Math.random()*.5,
    waterTemp:22
  });
  if(state.readings.length>300)state.readings.shift();

  document.getElementById('currentSpeed').textContent=msToKnots(speed);
  document.getElementById('windDir').textContent=getDir(deg);
  document.getElementById('windGust').textContent=msToKnots(speed*1.3);
  document.getElementById('waterTempMain').textContent='22°';
  document.getElementById('temp').textContent='25°';
  document.getElementById('compassArrow').style.transform=`translateX(-50%) rotate(${deg}deg)`;

  renderHistory();
},2000);

function renderHistory(){
  const data=state.readings.slice(-30);
  const c=document.getElementById('historyChart');
  c.innerHTML='';
  const max=Math.max(...data.map(d=>d.speed),1);
  data.forEach((p,i)=>{
    const b=document.createElement('div');
    const k=p.speed*KNOTS;
    b.className=`history-bar ${getWindClass(k)}`;
    b.style.height=`${(p.speed/max)*140}px`;
    b.style.left=`${i*10}px`;
    b.style.width='6px';
    c.appendChild(b);
  });

  document.getElementById('recentHoursTable').innerHTML=data.slice(-10).reverse().map(p=>{
    return`
    <tr>
      <td>${p.timestamp.toLocaleTimeString('he-IL',{hour:'2-digit',minute:'2-digit'})}</td>
      <td>${msToKnots(p.speed)}</td>
      <td class="text-orange-500">${msToKnots(p.gust)}</td>
      <td class="text-center">
        <i class="fas fa-arrow-up text-sky-600" style="transform:rotate(${p.deg}deg)"></i>
      </td>
      <td>${p.wave.toFixed(1)}</td>
      <td>${p.waterTemp}°</td>
    </tr>`;
  }).join('');
}
</script>
</body>
</html>
